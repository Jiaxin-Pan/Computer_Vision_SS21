clear
%1. create some data with n=5
d1 = rand(1,3,'single');
d1 = rand(1,5,'single');
d2 = rand(1,5,'single');
d2 = rand(1,5,'single');
d3 = rand(1,5,'single');
d4 = 4*d1-3*d2 + 2*d3 -1

d4 =

  1×5 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> row vector

    2.4905    2.2607   -0.0282   -1.1515    0.4446

D = [transpose(d1) transpose(d2) transpose(d3) transpose(d4)]

D =

  5×4 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> matrix

    0.9593    0.3500    0.3517    2.4905
    0.5472    0.1966    0.8308    2.2607
    0.1386    0.2511    0.5853   -0.0282
    0.1493    0.6160    0.5497   -1.1515
    0.2575    0.4733    0.9172    0.4446

eps = 1.e-4

eps =

   1.0000e-04

D = D+eps*rand

D =

  5×4 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> matrix

    0.9593    0.3500    0.3517    2.4906
    0.5472    0.1966    0.8309    2.2608
    0.1387    0.2511    0.5853   -0.0282
    0.1493    0.6161    0.5498   -1.1515
    0.2575    0.4733    0.9172    0.4446

%2. Find the coefficients x solving the system Dx = b
%(a) Compute the SVD for the matrix D.
[U,S,V] = svd(D)

U =

  5×5 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> matrix

   -0.7049   -0.0597    0.6687    0.0623    0.2203
   -0.6439    0.1187   -0.4762    0.0151   -0.5867
   -0.0435    0.3970   -0.1890    0.8443    0.3032
    0.2230    0.7144    0.4601   -0.0508   -0.4750
   -0.1921    0.5607   -0.2804   -0.5295    0.5382


S =

  5×4 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> matrix

    3.8183         0         0         0
         0    1.5646         0         0
         0         0    0.5120         0
         0         0         0    0.0639
         0         0         0         0


V =

  4×4 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> matrix

   -0.2752    0.2005    0.6859    0.6431
   -0.0885    0.5162    0.4760   -0.7065
   -0.2257    0.7778   -0.5377    0.2343
   -0.9303   -0.2972   -0.1177   -0.1799

%(b) Compute the Moore-Penrose pseudo-inverse using the result from (a), and compare it to
%the output of the MATLAB function pinv.
Dp1 =V*inv(S)*transpose(U) 
{Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('inv')" style="font-weight:bold">inv</a>
Matrix must be square.
} 
St = transpose(S)

St =

  4×5 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> matrix

    3.8183         0         0         0         0
         0    1.5646         0         0         0
         0         0    0.5120         0         0
         0         0         0    0.0639         0

St = St(:,1:4)

St =

  4×4 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> matrix

    3.8183         0         0         0
         0    1.5646         0         0
         0         0    0.5120         0
         0         0         0    0.0639

St = inv(St)

St =

  4×4 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> matrix

    0.2619         0         0         0
         0    0.6391         0         0
         0         0    1.9530         0
         0         0         0   15.6446

zerocol = [0;0;0;0]

zerocol =

     0
     0
     0
     0

St = [St zerocol]

St =

  4×5 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> matrix

    0.2619         0         0         0         0
         0    0.6391         0         0         0
         0         0    1.9530         0         0
         0         0         0   15.6446         0

Dp1 =V*St*transpose(U)

Dp1 =

  4×5 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> matrix

    1.5657   -0.4248    8.2959    0.1803   -5.6173
   -0.0702   -0.5551   -9.3762    1.2202    5.7815
   -0.4619    0.6524    3.4935   -0.3275   -1.3565
   -0.1459    0.2014   -2.3979   -0.1527    1.4951

Dp2 = pinv(D)

Dp2 =

  4×5 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> matrix

    1.5657   -0.4248    8.2959    0.1803   -5.6173
   -0.0702   -0.5551   -9.3762    1.2202    5.7815
   -0.4619    0.6524    3.4935   -0.3275   -1.3565
   -0.1459    0.2014   -2.3979   -0.1527    1.4951

% the above two are the same
b = [1;1;1;1;1]

b =

     1
     1
     1
     1
     1

x = D\b

x =

  4×1 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> column vector

    3.9998
   -2.9998
    1.9999
   -0.9999

%(c) Compute the coefficients x, and compare it to the true solution x.
x = D\b

x =

  4×1 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> column vector

    3.9998
   -2.9998
    1.9999
   -0.9999

% the real solution should be [4;-3;2;-1]
%Repeat the two previous questions, by setting m to a higher value. How is the precision impacted?
d1 = rand(1,7,'single');
d2 = rand(1,7,'single');
d3 = rand(1,7,'single');
d4 = 4*d1-3*d2 + 2*d3 -1

d4 =

  1×7 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> row vector

    0.0157    0.8015    0.7545    0.6219   -1.7735    0.3841    0.6378

D = [transpose(d1) transpose(d2) transpose(d3) transpose(d4)]

D =

  7×4 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> matrix

    0.7572    0.7792    0.1622    0.0157
    0.7537    0.9340    0.7943    0.8015
    0.3804    0.1299    0.3112    0.7545
    0.5678    0.5688    0.5285    0.6219
    0.0759    0.4694    0.1656   -1.7735
    0.0540    0.0119    0.6020    0.3841
    0.5308    0.3371    0.2630    0.6378

D = D+eps*rand

D =

  7×4 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> matrix

    0.7573    0.7792    0.1622    0.0157
    0.7538    0.9341    0.7943    0.8015
    0.3805    0.1300    0.3113    0.7546
    0.5679    0.5689    0.5286    0.6219
    0.0759    0.4695    0.1657   -1.7734
    0.0540    0.0120    0.6020    0.3841
    0.5309    0.3372    0.2630    0.6378

x7 = D\b
{Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('mldivide')" style="font-weight:bold"> \ </a>
Matrix dimensions must agree.
} 
b2 = [1;1;1;1;1;1;1]

b2 =

     1
     1
     1
     1
     1
     1
     1

x7 = D\b
{Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('mldivide')" style="font-weight:bold"> \ </a>
Matrix dimensions must agree.
} 
x7 = D\b2

x7 =

  4×1 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> column vector

    3.9995
   -2.9996
    1.9997
   -0.9999

%the error is larger with n larger
%4. We assume in the following that m = 3, hence we have infinitely many solutions.
d1 = rand(1,3,'single');
d2 = rand(1,3,'single');
d3 = rand(1,3,'single');
d4 = 4*d1-3*d2 + 2*d3 -1

d4 =

  1×3 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> row vector

    1.8102    2.9573   -0.8612

D = [transpose(d1) transpose(d2) transpose(d3) transpose(d4)]

D =

  3×4 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> matrix

    0.6892    0.0838    0.1524    1.8102
    0.7482    0.2290    0.8258    2.9573
    0.4505    0.9133    0.5383   -0.8612

D = D+eps*rand

D =

  3×4 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> matrix

    0.6893    0.0839    0.1525    1.8102
    0.7483    0.2291    0.8259    2.9574
    0.4506    0.9134    0.5384   -0.8611

%(a) Solve again the linear system using questions (1) and (2).
%Thus rank(D) = 3 and dim(kernel(D)) = 1.
rank(D)

ans =

     3

v = null(D)

v =

  4×1 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> column vector

   -0.5120
    0.7052
   -0.4479
    0.2000

%(c) According to the last slide of Chapter 1, we know that the following statement holds:
xmin = A+b is among all minimizers of kAx 　 bk2 the one with the smallest norm jxj.
 xmin = A+b is among all minimizers of kAx 　 bk2 the one with the smallest norm jxj.
            ↑
{Error: Invalid expression. Check for missing multiplication operator, missing or unbalanced delimiters, or
other syntax error. To construct matrices, use brackets instead of parentheses.
} 
nam = -100:1:100;
b = [1;1;1]

b =

     1
     1
     1

x = D\b

x =

  4×1 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> column vector

         0
    2.5082
   -1.4986
    0.5624

xn = x+nam.*v

xn =

  4×201 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> matrix

  Columns 1 through 10

   51.2023   50.6903   50.1783   49.6662   49.1542   48.6422   48.1302   47.6181   47.1061   46.5941
  -68.0068  -67.3017  -66.5965  -65.8914  -65.1862  -64.4811  -63.7759  -63.0708  -62.3656  -61.6605
   43.2890   42.8412   42.3933   41.9454   41.4975   41.0497   40.6018   40.1539   39.7060   39.2582
  -19.4381  -19.2381  -19.0381  -18.8381  -18.6381  -18.4381  -18.2381  -18.0381  -17.8381  -17.6381

  Columns 11 through 20

   46.0821   45.5700   45.0580   44.5460   44.0340   43.5220   43.0099   42.4979   41.9859   41.4739
  -60.9553  -60.2502  -59.5450  -58.8399  -58.1347  -57.4296  -56.7244  -56.0193  -55.3141  -54.6090
   38.8103   38.3624   37.9145   37.4667   37.0188   36.5709   36.1230   35.6751   35.2273   34.7794
  -17.4381  -17.2381  -17.0381  -16.8381  -16.6381  -16.4381  -16.2381  -16.0381  -15.8381  -15.6380

  Columns 21 through 30

   40.9618   40.4498   39.9378   39.4258   38.9137   38.4017   37.8897   37.3777   36.8657   36.3536
  -53.9038  -53.1987  -52.4935  -51.7884  -51.0832  -50.3781  -49.6729  -48.9678  -48.2626  -47.5575
   34.3315   33.8836   33.4358   32.9879   32.5400   32.0921   31.6443   31.1964   30.7485   30.3006
  -15.4380  -15.2380  -15.0380  -14.8380  -14.6380  -14.4380  -14.2380  -14.0380  -13.8380  -13.6380

  Columns 31 through 40

   35.8416   35.3296   34.8176   34.3055   33.7935   33.2815   32.7695   32.2574   31.7454   31.2334
  -46.8523  -46.1472  -45.4420  -44.7369  -44.0317  -43.3266  -42.6214  -41.9163  -41.2111  -40.5060
   29.8528   29.4049   28.9570   28.5091   28.0613   27.6134   27.1655   26.7176   26.2697   25.8219
  -13.4380  -13.2380  -13.0380  -12.8380  -12.6380  -12.4380  -12.2380  -12.0380  -11.8380  -11.6379

  Columns 41 through 50

   30.7214   30.2094   29.6973   29.1853   28.6733   28.1613   27.6492   27.1372   26.6252   26.1132
  -39.8008  -39.0956  -38.3905  -37.6853  -36.9802  -36.2750  -35.5699  -34.8647  -34.1596  -33.4544
   25.3740   24.9261   24.4782   24.0304   23.5825   23.1346   22.6867   22.2389   21.7910   21.3431
  -11.4379  -11.2379  -11.0379  -10.8379  -10.6379  -10.4379  -10.2379  -10.0379   -9.8379   -9.6379

  Columns 51 through 60

   25.6011   25.0891   24.5771   24.0651   23.5531   23.0410   22.5290   22.0170   21.5050   20.9929
  -32.7493  -32.0441  -31.3390  -30.6338  -29.9287  -29.2235  -28.5184  -27.8132  -27.1081  -26.4029
   20.8952   20.4474   19.9995   19.5516   19.1037   18.6559   18.2080   17.7601   17.3122   16.8643
   -9.4379   -9.2379   -9.0379   -8.8379   -8.6379   -8.4379   -8.2379   -8.0379   -7.8379   -7.6378

  Columns 61 through 70

   20.4809   19.9689   19.4569   18.9449   18.4328   17.9208   17.4088   16.8968   16.3847   15.8727
  -25.6978  -24.9926  -24.2875  -23.5823  -22.8772  -22.1720  -21.4669  -20.7617  -20.0566  -19.3514
   16.4165   15.9686   15.5207   15.0728   14.6250   14.1771   13.7292   13.2813   12.8335   12.3856
   -7.4378   -7.2378   -7.0378   -6.8378   -6.6378   -6.4378   -6.2378   -6.0378   -5.8378   -5.6378

  Columns 71 through 80

   15.3607   14.8487   14.3366   13.8246   13.3126   12.8006   12.2886   11.7765   11.2645   10.7525
  -18.6463  -17.9411  -17.2360  -16.5308  -15.8257  -15.1205  -14.4154  -13.7102  -13.0051  -12.2999
   11.9377   11.4898   11.0420   10.5941   10.1462    9.6983    9.2505    8.8026    8.3547    7.9068
   -5.4378   -5.2378   -5.0378   -4.8378   -4.6378   -4.4378   -4.2378   -4.0378   -3.8378   -3.6377

  Columns 81 through 90

   10.2405    9.7284    9.2164    8.7044    8.1924    7.6803    7.1683    6.6563    6.1443    5.6323
  -11.5948  -10.8896  -10.1845   -9.4793   -8.7742   -8.0690   -7.3639   -6.6587   -5.9536   -5.2484
    7.4590    7.0111    6.5632    6.1153    5.6674    5.2196    4.7717    4.3238    3.8759    3.4281
   -3.4377   -3.2377   -3.0377   -2.8377   -2.6377   -2.4377   -2.2377   -2.0377   -1.8377   -1.6377

  Columns 91 through 100

    5.1202    4.6082    4.0962    3.5842    3.0721    2.5601    2.0481    1.5361    1.0240    0.5120
   -4.5433   -3.8381   -3.1330   -2.4278   -1.7227   -1.0175   -0.3124    0.3928    1.0979    1.8031
    2.9802    2.5323    2.0844    1.6366    1.1887    0.7408    0.2929   -0.1549   -0.6028   -1.0507
   -1.4377   -1.2377   -1.0377   -0.8377   -0.6377   -0.4377   -0.2377   -0.0377    0.1623    0.3624

  Columns 101 through 110

         0   -0.5120   -1.0240   -1.5361   -2.0481   -2.5601   -3.0721   -3.5842   -4.0962   -4.6082
    2.5082    3.2134    3.9185    4.6237    5.3288    6.0340    6.7391    7.4443    8.1494    8.8546
   -1.4986   -1.9464   -2.3943   -2.8422   -3.2901   -3.7380   -4.1858   -4.6337   -5.0816   -5.5295
    0.5624    0.7624    0.9624    1.1624    1.3624    1.5624    1.7624    1.9624    2.1624    2.3624

  Columns 111 through 120

   -5.1202   -5.6323   -6.1443   -6.6563   -7.1683   -7.6803   -8.1924   -8.7044   -9.2164   -9.7284
    9.5597   10.2649   10.9700   11.6752   12.3803   13.0855   13.7906   14.4958   15.2009   15.9061
   -5.9773   -6.4252   -6.8731   -7.3210   -7.7688   -8.2167   -8.6646   -9.1125   -9.5603  -10.0082
    2.5624    2.7624    2.9624    3.1624    3.3624    3.5624    3.7624    3.9624    4.1624    4.3625

  Columns 121 through 130

  -10.2405  -10.7525  -11.2645  -11.7765  -12.2886  -12.8006  -13.3126  -13.8246  -14.3366  -14.8487
   16.6112   17.3164   18.0216   18.7267   19.4319   20.1370   20.8422   21.5473   22.2525   22.9576
  -10.4561  -10.9040  -11.3518  -11.7997  -12.2476  -12.6955  -13.1433  -13.5912  -14.0391  -14.4870
    4.5625    4.7625    4.9625    5.1625    5.3625    5.5625    5.7625    5.9625    6.1625    6.3625

  Columns 131 through 140

  -15.3607  -15.8727  -16.3847  -16.8968  -17.4088  -17.9208  -18.4328  -18.9449  -19.4569  -19.9689
   23.6628   24.3679   25.0731   25.7782   26.4834   27.1885   27.8937   28.5988   29.3040   30.0091
  -14.9349  -15.3827  -15.8306  -16.2785  -16.7264  -17.1742  -17.6221  -18.0700  -18.5179  -18.9657
    6.5625    6.7625    6.9625    7.1625    7.3625    7.5625    7.7625    7.9625    8.1625    8.3625

  Columns 141 through 150

  -20.4809  -20.9929  -21.5050  -22.0170  -22.5290  -23.0410  -23.5531  -24.0651  -24.5771  -25.0891
   30.7143   31.4194   32.1246   32.8297   33.5349   34.2400   34.9452   35.6503   36.3555   37.0606
  -19.4136  -19.8615  -20.3094  -20.7572  -21.2051  -21.6530  -22.1009  -22.5487  -22.9966  -23.4445
    8.5626    8.7626    8.9626    9.1626    9.3626    9.5626    9.7626    9.9626   10.1626   10.3626

  Columns 151 through 160

  -25.6011  -26.1132  -26.6252  -27.1372  -27.6492  -28.1613  -28.6733  -29.1853  -29.6973  -30.2094
   37.7658   38.4709   39.1761   39.8812   40.5864   41.2915   41.9967   42.7018   43.4070   44.1121
  -23.8924  -24.3403  -24.7881  -25.2360  -25.6839  -26.1318  -26.5796  -27.0275  -27.4754  -27.9233
   10.5626   10.7626   10.9626   11.1626   11.3626   11.5626   11.7626   11.9626   12.1626   12.3626

  Columns 161 through 170

  -30.7214  -31.2334  -31.7454  -32.2574  -32.7695  -33.2815  -33.7935  -34.3055  -34.8176  -35.3296
   44.8173   45.5224   46.2276   46.9327   47.6379   48.3430   49.0482   49.7533   50.4585   51.1636
  -28.3711  -28.8190  -29.2669  -29.7148  -30.1626  -30.6105  -31.0584  -31.5063  -31.9541  -32.4020
   12.5627   12.7627   12.9627   13.1627   13.3627   13.5627   13.7627   13.9627   14.1627   14.3627

  Columns 171 through 180

  -35.8416  -36.3536  -36.8657  -37.3777  -37.8897  -38.4017  -38.9137  -39.4258  -39.9378  -40.4498
   51.8688   52.5739   53.2791   53.9842   54.6894   55.3945   56.0997   56.8048   57.5100   58.2151
  -32.8499  -33.2978  -33.7456  -34.1935  -34.6414  -35.0893  -35.5372  -35.9850  -36.4329  -36.8808
   14.5627   14.7627   14.9627   15.1627   15.3627   15.5627   15.7627   15.9627   16.1627   16.3627

  Columns 181 through 190

  -40.9618  -41.4739  -41.9859  -42.4979  -43.0099  -43.5220  -44.0340  -44.5460  -45.0580  -45.5700
   58.9203   59.6254   60.3306   61.0357   61.7409   62.4460   63.1512   63.8563   64.5615   65.2666
  -37.3287  -37.7765  -38.2244  -38.6723  -39.1202  -39.5680  -40.0159  -40.4638  -40.9117  -41.3595
   16.5628   16.7628   16.9628   17.1628   17.3628   17.5628   17.7628   17.9628   18.1628   18.3628

  Columns 191 through 200

  -46.0821  -46.5941  -47.1061  -47.6181  -48.1302  -48.6422  -49.1542  -49.6662  -50.1783  -50.6903
   65.9718   66.6769   67.3821   68.0872   68.7924   69.4975   70.2027   70.9079   71.6130   72.3181
  -41.8074  -42.2553  -42.7032  -43.1510  -43.5989  -44.0468  -44.4947  -44.9426  -45.3904  -45.8383
   18.5628   18.7628   18.9628   19.1628   19.3628   19.5628   19.7628   19.9628   20.1628   20.3628

  Column 201

  -51.2023
   73.0233
  -46.2862
   20.5629

yn = sum(xn.^2,1).^(1/2); %sum(A,1)表示把每列相加变为一个行向量
err = D*xn-b

err =

  3×201 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> matrix

   1.0e-04 *

  Columns 1 through 10

   -0.1907   -0.1907   -0.1907   -0.1526   -0.1907   -0.1526   -0.1907   -0.1526   -0.1526   -0.1144
    0.0763    0.0763    0.0763    0.0763    0.0763         0         0         0    0.0763    0.0763
   -0.0381   -0.0381   -0.0763   -0.1144   -0.0381   -0.0381   -0.0763   -0.1144   -0.0763   -0.0763

  Columns 11 through 20

   -0.1526   -0.1526   -0.1907   -0.1144   -0.1526   -0.1526   -0.1907   -0.1526   -0.1144   -0.1144
    0.0763         0         0    0.0381    0.0381    0.0381    0.0381         0    0.0763    0.1144
   -0.0763   -0.0763   -0.0381   -0.1144   -0.1144   -0.0381   -0.0381   -0.0763   -0.0763   -0.0381

  Columns 21 through 30

   -0.1526   -0.1144   -0.1526   -0.0954   -0.1144   -0.1144   -0.1144   -0.1144   -0.1144   -0.1144
    0.0381    0.0381    0.0381    0.0763    0.0381    0.0381    0.0763    0.0381    0.0381         0
   -0.1144   -0.1144   -0.0763   -0.0763   -0.1144   -0.1144   -0.0763   -0.0763   -0.0763   -0.1144

  Columns 31 through 40

   -0.1335   -0.0954   -0.1335   -0.1144   -0.0954   -0.0763   -0.0954   -0.1144   -0.0954   -0.0954
         0    0.0381         0    0.0381    0.0763    0.0763    0.0381    0.0381    0.0381         0
   -0.0954   -0.0763   -0.0954   -0.0954   -0.0572   -0.0954   -0.0763   -0.0763   -0.0572   -0.0763

  Columns 41 through 50

   -0.0954   -0.0954   -0.0954   -0.0763   -0.0954   -0.0763   -0.0954   -0.0763   -0.0954   -0.0954
    0.0381    0.0381    0.0763    0.0763    0.0381         0         0    0.0381    0.0381         0
   -0.0954   -0.0763   -0.0572   -0.0763   -0.0763   -0.0763   -0.0572   -0.0572   -0.0763   -0.0763

  Columns 51 through 60

   -0.0763   -0.0763   -0.0954   -0.0954   -0.0763   -0.0572   -0.0572   -0.0763   -0.0572   -0.0572
    0.0381         0    0.0381    0.0381    0.0763    0.0572    0.0191    0.0381    0.0381    0.0381
   -0.0572   -0.0572   -0.0572   -0.0572   -0.0381   -0.0572   -0.0381   -0.0381   -0.0381   -0.0381

  Columns 61 through 70

   -0.0668   -0.0668   -0.0572   -0.0572   -0.0572   -0.0668   -0.0668   -0.0477   -0.0477   -0.0477
    0.0191    0.0191         0    0.0191    0.0191    0.0191    0.0191    0.0191    0.0191    0.0191
   -0.0381   -0.0381   -0.0381   -0.0477   -0.0477   -0.0286   -0.0381   -0.0191   -0.0381   -0.0286

  Columns 71 through 80

   -0.0477   -0.0477   -0.0477   -0.0572   -0.0477   -0.0381   -0.0381   -0.0286   -0.0286   -0.0334
    0.0191    0.0191    0.0191    0.0191    0.0191         0    0.0191    0.0191    0.0095    0.0095
   -0.0286   -0.0191   -0.0286   -0.0286   -0.0191   -0.0286   -0.0191   -0.0191   -0.0191   -0.0095

  Columns 81 through 90

   -0.0334   -0.0286   -0.0286   -0.0334   -0.0286   -0.0238   -0.0191   -0.0191   -0.0238   -0.0215
    0.0095    0.0095    0.0191    0.0095         0    0.0095    0.0095    0.0143    0.0095    0.0048
   -0.0143   -0.0143   -0.0143   -0.0048   -0.0191   -0.0095   -0.0095   -0.0048   -0.0119   -0.0072

  Columns 91 through 100

   -0.0191   -0.0143   -0.0143   -0.0119   -0.0119   -0.0101   -0.0072   -0.0072   -0.0048   -0.0036
    0.0048    0.0048    0.0024    0.0048    0.0048    0.0024    0.0024    0.0036    0.0024    0.0012
   -0.0072   -0.0095   -0.0048   -0.0012   -0.0024   -0.0036   -0.0006         0    0.0012    0.0024

  Columns 101 through 110

   -0.0012         0    0.0024    0.0036    0.0024    0.0095    0.0095    0.0072    0.0119    0.0095
    0.0024    0.0012    0.0024    0.0024         0         0   -0.0048   -0.0048   -0.0048   -0.0095
    0.0048    0.0048    0.0036    0.0072    0.0072    0.0095    0.0119    0.0143    0.0095    0.0143

  Columns 111 through 120

    0.0143    0.0143    0.0191    0.0238    0.0191    0.0191    0.0191    0.0286    0.0286    0.0286
   -0.0095         0         0         0         0   -0.0191   -0.0095   -0.0095   -0.0095    0.0095
    0.0191    0.0191    0.0238    0.0238    0.0191    0.0143    0.0191    0.0191    0.0286    0.0191

  Columns 121 through 130

    0.0381    0.0381    0.0381    0.0381    0.0381    0.0381    0.0477    0.0477    0.0477    0.0381
         0         0         0   -0.0191   -0.0191   -0.0191   -0.0191         0   -0.0191   -0.0381
    0.0191    0.0191    0.0191    0.0286    0.0191    0.0286    0.0191    0.0381    0.0286    0.0381

  Columns 131 through 140

    0.0477    0.0477    0.0477    0.0477    0.0572    0.0668    0.0668    0.0572    0.0572    0.0572
   -0.0191   -0.0191   -0.0191   -0.0191         0         0   -0.0191   -0.0381   -0.0191   -0.0191
    0.0286    0.0381    0.0286    0.0381    0.0381    0.0572    0.0381    0.0381    0.0572    0.0381

  Columns 141 through 150

    0.0763    0.0572    0.0763    0.0572    0.0763    0.0572    0.0763    0.0954    0.0763    0.0763
         0   -0.0381   -0.0381   -0.0381   -0.0381   -0.0381   -0.0381         0   -0.0381         0
    0.0381    0.0381    0.0191    0.0191    0.0191    0.0191    0.0381    0.0572    0.0191    0.0381

  Columns 151 through 160

    0.0763    0.0954    0.0954    0.0572    0.0954    0.0763    0.0954    0.0763    0.0763    0.0954
         0   -0.0381   -0.0381   -0.0381   -0.0381   -0.0381         0   -0.0381   -0.0381         0
    0.0572    0.0381    0.0381    0.0572    0.0381    0.0381    0.0191    0.0381    0.0572    0.0381

  Columns 161 through 170

    0.0954    0.0954    0.0954    0.0954    0.0954    0.0763    0.0954    0.1335    0.1144    0.1144
   -0.0763   -0.0381   -0.0381         0   -0.0381   -0.0381   -0.0381   -0.0381   -0.0381   -0.0381
    0.0381    0.0572    0.0572    0.0381    0.0381    0.0763    0.0572    0.0763    0.0381    0.0763

  Columns 171 through 180

    0.1335    0.1335    0.1144    0.1335    0.0954    0.1335    0.1144    0.0763    0.1526    0.1144
         0         0   -0.0381         0   -0.0381         0         0   -0.0381         0   -0.0381
    0.0381    0.0763    0.0763    0.0763    0.0763    0.0763    0.0763    0.0763    0.0763    0.0763

  Columns 181 through 190

    0.1526    0.1144    0.0763    0.1144    0.1526    0.1144    0.1144    0.0763    0.1526    0.1144
   -0.0381   -0.1144   -0.1144   -0.0381   -0.0763   -0.0763   -0.0763   -0.0763         0         0
    0.1144    0.0763    0.0763    0.0763    0.1144    0.0381    0.0763    0.0763    0.1144    0.0763

  Columns 191 through 200

    0.1144    0.0763    0.1144    0.1144    0.1526    0.1526    0.1526    0.1144    0.1526    0.1526
   -0.0763         0   -0.0763         0         0   -0.0763         0   -0.0763   -0.0763   -0.0763
    0.1144    0.1144    0.1526    0.1526    0.1144    0.1144    0.1526    0.1526    0.1144    0.1526

  Column 201

    0.1526
   -0.0763
    0.1144

en = sum(err.^2,1); 
figure
subplot(1,2,1)
plot(xn,yn)
subplot(1,2,2)
plot(xn,en)
xmin = pinv(D)*b

xmin =

  4×1 <a href="matlab:helpPopup single" style="font-weight:bold">single</a> column vector

    1.3069
    0.7085
   -0.3554
    0.0519

min(yn)

ans =

  <a href="matlab:helpPopup single" style="font-weight:bold">single</a>

    1.5935

norm(xmin)

ans =

  <a href="matlab:helpPopup single" style="font-weight:bold">single</a>

    1.5293

min(en)

ans =

  <a href="matlab:helpPopup single" style="font-weight:bold">single</a>

  1.9895e-13

norm(D*xmin-b).^2

ans =

  <a href="matlab:helpPopup single" style="font-weight:bold">single</a>

  4.6896e-13

diary off
